import networkx as nx
from scipy.stats import kendalltau
import numpy as np

def ranking_correlation(y_out, true_val, node_num):
  kt,_ = kendalltau(y_out[:node_num], true_val[:node_num])
  return kt

G = nx.karate_club_graph()
exact_bet = np.array([0.43763528138528146,  
0.053936688311688304,  
0.14365680615680618,   
0.011909271284271283,  
0.0006313131313131313, 
0.02998737373737374,
0.029987373737373736,
0.0,
0.05592682780182781,
0.0008477633477633478,
0.0006313131313131313,
0.0,
0.0,
0.04586339586339586,
0.0,
0.0,
0.0,
0.0,
0.0,
0.03247504810004811,
0.0,
0.0,
0.0,
0.017613636363636363,
0.0022095959595959595,
0.0038404882154882154,
0.0,
0.02233345358345358,
0.0017947330447330447,
0.0029220779220779218,
0.014411976911976909,
0.13827561327561325,
0.145247113997114,
0.30407497594997596])

output_bet_linear = np.array([11.273609,
6.483307,
5.0305166,
2.0022159,
8.0232,
7.1238623,
5.9274573,
2.960104,
7.3415394,
2.1265936,
4.1348743,
2.6145134,
3.47313,
3.7109706,
2.6487784,
2.1143696,
2.794087,
3.1022284,
2.1324403,
3.6621506,
1.2308034,
1.005088,
1.5403788,
1.6888832,
1.3732153,
1.1941657,
2.170655,
2.4477634,
2.287421,
1.092025,
2.1017323,
7.3065476,
-0.66096485,
0.72498596])

output_bet = np.array([50.159775,
10.784271,
31.56219,
5.2807875,
6.6050696,
3.7330816,
12.731437,
6.9180117,
4.708364,
3.698605,
4.779331,
3.2429411,
3.177694,
12.278597,
3.0041292,
4.985804,
4.2366376,
3.1891608,
3.6995883,
5.5179977,
2.5336103,
2.7454464,
2.740495,
10.70341,
5.4057393,
3.6821315,
3.411542,
2.9721324,
4.845378,
4.5641947,
6.756119,
29.28344,
14.376797,
17.214787])

print(ranking_correlation(exact_bet, output_bet_linear, 34)) #0.19375604755067283
print(ranking_correlation(exact_bet, output_bet,34)) #0.5964646954010909
